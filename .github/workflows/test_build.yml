name: '[ðŸ§ª] Test build'
run-name: '[ðŸ§ª] Test build on `${{ github.ref }}`'

on:
    push:
        branches:
            - master
            - dev
    pull_request:
    workflow_dispatch:

jobs:
    build:
        strategy:
            matrix:
                os:
                    - ubuntu-22.04
                    - ubuntu-20.04
                    - macos-12
                    - macos-11
        runs-on: ${{ matrix.os }}
        name: '[ðŸ§ª] Test Build on ${{ matrix.os }}'
        steps:
            - name: '[ðŸ“¥] checkout'
              uses: actions/checkout@v3
              with:
                  fetch-depth: 0

            - name: '[ðŸ‘·] run build script on git repository'
              run: |
                  ./build/build.sh --full --debug

            - name: '[ðŸ”¥] clean and remove git'
              run: |
                  git clean -xdf
                  rm -rf .git

            - name: '[ðŸ‘·] run build script on non-git directory'
              run: |
                  ./build/build.sh --full --debug

    success:
        needs: [build]
        if: ${{ success() }}
        name: '[ðŸ§ª] Success'
        runs-on: ubuntu-latest
        steps:
            - name: '[ðŸ¥³] Success'
              run: echo "ðŸ¥³ Checks passed successfully!"